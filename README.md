# gofastcopy

## Summary
批量复制大量小文件的加速工具

## 原理
利用CPU多核并行特性，在内存中建立2个队列，一个队列持续从源文件夹读取小文件存入内存，一个队列不断写入文件到目标文件夹。

## 场景
从慢速机械硬盘HDD复制到快速固态硬盘SSD时，读取队列无需等待排队，写入队列极快，只要内存中有文件，即会落盘；

从SSD复制到HDD时，读取队列会提前预读文件到内存中，写入队列可以节省文件元数据的读取时间，当小文件数量到达10W以上时，这个累计时间较为客观；


## 性能
279.5GB文件，文件皆为2MB左右，从HDD复制到SSD：

```
rsync 需要 7205 秒，
gofastcopy 需要 6357 秒，快了 848 秒
```

## Usage
### 重新打开终端，运行
```Bash
./gofastcopy

# --debug 默认 false ： 是否显示各种调试信息
#
# --source-dir 默认为 空 ： 源文件夹
# --target-dir 默认为 空 ： 复制到的目标文件夹
# --exclude-dir 默认为 空 ： 如果该文件夹中存在同路径文件，该文件将被排除
# --file-ext 默认为 空 ：譬如，设置为 .mp4 ，则仅复制 mp4 文件
#
# --min-size 默认为 -1 ：文件大小【小于】该值的文件将被忽略
# --max-size 默认为 -1 ： 文件大小【大于】该值的文件将被忽略
# --min-age 默认为 空 ： 文件最后修改时间【早于】该值的文件将被忽略
# --max-age 默认为 空 ：文件最后修改时间【晚于】该值的文件将被忽略
#
# --ignore-dot-file 默认 true ： 是否忽略点（.）开头的文件
# --ignore-empty-folder 默认 true ：是否忽略空文件夹
# --overwrite 默认 false ： 是否允许覆盖已经存在的文件
#
# --with-limit-memory 默认 false ： 低内存模式，并行任务固定为 4.
# --with-time-utc 默认 false ： max-age/min-age 比较时间时，默认使用本地时间，如果要使用UTC时区时间，此项设置为 true
#
# --threads 默认 0 ：强制指定并行线程数，默认线程数限制在32～128之间，该参数可以无限制强制指定线程数
#
#

